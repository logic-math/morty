## 执行摘要

已完成 Job 4 Task 1-5 的实现：

### 实现的功能

1. **状态转换逻辑** (`doing_is_valid_transition`, `doing_update_job_status`)
   - PENDING → RUNNING：Job 开始执行
   - RUNNING → COMPLETED：执行成功
   - RUNNING → FAILED：执行失败
   - RUNNING → PENDING：失败重试时重置
   - FAILED → PENDING/RUNNING：重试失败 Job

2. **失败重试机制** (`DOING_MAX_RETRY_COUNT=3`, `doing_should_retry`, `doing_get_retry_count`)
   - 最多重试 3 次
   - 自动增加 retry_count
   - 超过最大次数后标记为 FAILED

3. **`doing_mark_completed()`**
   - 将 Job 标记为 COMPLETED
   - 记录完成摘要
   - 状态转换验证

4. **`doing_mark_failed()`**
   - 处理失败逻辑
   - 自动重试或彻底失败
   - 返回 2 表示需要重试，返回 1 表示彻底失败

5. **中断恢复逻辑** (`doing_interrupt_handler`, `doing_was_interrupted`, `doing_resume_job`)
   - 信号处理保存中断状态
   - 检测中断标记并从断点恢复
   - 清除中断标记继续执行

### 验证结果

所有 6 个测试用例通过：
- PENDING → RUNNING 转换 ✓
- RUNNING → COMPLETED 转换 ✓
- RUNNING → FAILED 首次（重试）✓
- 最大重试次数限制 ✓
- 无效状态转换拒绝 ✓
- 中断恢复逻辑 ✓

<!-- RALPH_STATUS -->
{
  "module": "doing",
  "job": "job_4",
  "status": "COMPLETED",
  "tasks_completed": 5,
  "tasks_total": 5,
  "loop_count": 1,
  "debug_issues": 0,
  "summary": "实现状态转换逻辑、失败重试机制(最多3次)、doing_mark_completed()、doing_mark_failed()和中断恢复逻辑。所有测试通过。"
}
<!-- END_RALPH_STATUS -->
